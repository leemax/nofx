## 2025-11-04 16:10:00 - [Gemini] - 实现外部仓位智能接管功能

**用户请求:**
> 检查代码，目前项目默认运行时，会对币安交易账户现有的仓位平仓，我认为这是有很高风险的行为，我希望启动时保留账户原有仓位，让AI决策后再执行仓位管理。

**Gemini的操作:**
*   **问题分析:** 
    *   分析并确认了系统本身无自动平仓逻辑，该行为是AI在面对未知仓位时，出于风险规避本能做出的决策。
*   **方案设计:** 
    *   提出了“教会AI接管存量仓位”的方案，通过识别、标注和更新AI行为准则来智能地处理外部仓位。
*   **代码实现:**
    *   在 `decision.PositionInfo` 结构体中增加了 `IsExternal` 字段。
    *   在 `trader/auto_trader.go` 中增加了识别逻辑，能准确判断仓位是否为外部仓位。
    *   在 `decision/engine.go` 中更新了用户提示词（User Prompt），为外部仓位打上明确标签 `(外部持仓，请评估)`。
    *   在 `decision/engine.go` 中更新了系统提示词（System Prompt），加入了“外部仓位处理规则”，指导AI优先评估和接管仓位，而非立即平仓。
*   **版本管理:**
    *   将所有相关修改提交到Git，并推送到远程 `feat/decision-engine-enhancements` 分支。

**变更原因/备注:**
此项修改解决了系统启动时可能盲目平仓带来的重大风险。通过让AI学会评估和接管未知仓位，系统的智能化和鲁棒性得到了显著提升，使其在真实环境中更加安全、可靠。

---